<ion-header>
  <ion-toolbar>
    <ion-title>Vaccinations</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="addVaccination()">
        <ion-icon name="add-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container page-wrapper">
    <ion-segment [(ngModel)]="currentSegment">
      <ion-segment-button value="upcoming">
        <ion-label>Upcoming</ion-label>
      </ion-segment-button>
      <ion-segment-button value="completed">
        <ion-label>Completed</ion-label>
      </ion-segment-button>
      <ion-segment-button value="all">
        <ion-label>All</ion-label>
      </ion-segment-button>
    </ion-segment>

    <div [ngSwitch]="currentSegment">
      <!-- UPCOMING -->
      <div *ngSwitchCase="'upcoming'">
        <ion-grid>
          <ion-row>
            <ion-col size="12" size-md="6">
             <div class="grid">
               <ion-card *ngFor="let v of upcoming$ | async">
                <ion-card-header>
                  <ion-card-subtitle>
                    Due in {{ dueInDays(v.dateAdministered) }} days
                  </ion-card-subtitle>
                  <ion-card-title>{{ v.vaccineName }}</ion-card-title>
                </ion-card-header>
                <ion-card-content>
                  <p>Recommended date:
                    {{ v.dateAdministered | date:'MMMM d, yyyy' }}
                  </p>
                </ion-card-content>
              </ion-card>
             </div>
            </ion-col>
            <ion-col size="12" size-md="6">
              <app-vaccination-calendar *ngIf="upcoming$ | async as upcoming"
                [vaccinations]="upcoming">
              </app-vaccination-calendar>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>

      <!-- COMPLETED -->
      <div *ngSwitchCase="'completed'">
        <ion-list>
          <ion-item *ngFor="let v of completed$ | async">
            <ion-icon
              name="checkmark-circle"
              color="success"
              slot="start"
            ></ion-icon>
            <ion-label>
              <h2>{{ v.vaccineName }}</h2>
              <p>{{ v.dateAdministered | date:'MMMM d, yyyy' }}</p>
            </ion-label>
            <ion-button
              fill="clear"
              slot="end"
              (click)="viewVaccinationDetails(v.id)"
            >
              Details
            </ion-button>
          </ion-item>
        </ion-list>
      </div>

      <!-- ALL -->
      <div *ngSwitchCase="'all'">
        <ion-list-header>
          <ion-label>Upcoming</ion-label>
        </ion-list-header>
        <ion-item *ngFor="let v of upcoming$ | async">
          <ion-icon name="time" color="warning" slot="start"></ion-icon>
          <ion-label>
            <h2>{{ v.vaccineName }}</h2>
            <p>Due: {{ v.dateAdministered | date:'MMMM d, yyyy' }}</p>
          </ion-label>
          <ion-button
            fill="clear"
            slot="end"
            (click)="scheduleVaccination(v.id)"
          >
            Schedule
          </ion-button>
        </ion-item>

        <ion-list-header>
          <ion-label>Completed</ion-label>
        </ion-list-header>
        <ion-item *ngFor="let v of completed$ | async">
          <ion-icon
            name="checkmark-circle"
            color="success"
            slot="start"
          ></ion-icon>
          <ion-label>
            <h2>{{ v.vaccineName }}</h2>
            <p>{{ v.dateAdministered | date:'MMMM d, yyyy' }}</p>
          </ion-label>
          <ion-button
            fill="clear"
            slot="end"
            (click)="viewVaccinationDetails(v.id)"
          >
            Details
          </ion-button>
        </ion-item>
      </div>
    </div>
  </div>
</ion-content>
